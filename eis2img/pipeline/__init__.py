"""End-to-end encoding pipeline"""